name: Goose Winter Festival Triage
on:
  issues:
    types: [opened]

jobs:
  triage:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Goose
        run: |
          # Install goose
          curl -fsSL https://github.com/block/goose/releases/latest/download/goose-linux-amd64 -o goose
          chmod +x goose

      - name: Run Goose Triage
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          ./goose run --extension github "Analyze the new issue #${{ github.event.issue.number }} in ${{ github.repository }}. 
          1. Use the github extension to read the issue content.
          2. Categorize it as 'urgent' (if it mentions safety, security, or cancellations) or 'low-priority' (if it is general feedback, praise, or general info).
          3. Apply the appropriate category label AND the 'winter-festival' label.
          4. Post a comment:
             - If urgent: 'Thank you for reporting this safety/critical issue. Our team has been notified and will address this immediately.'
             - If low-priority: 'Thank you for your feedback/inquiry regarding the Winter Festival! We have triaged this and will get back to you soon.'"
